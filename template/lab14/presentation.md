---
## Front matter
lang: ru-RU
title: Лабораторная работа №14
subtitle: Настройка файловых служб Samba
author:
  - Спелов А. Н.
institute:
  - Российский университет дружбы народов, Москва, Россия
date: 5 декабря 2025

## i18n babel
babel-lang: russian
babel-otherlangs: english

## Formatting pdf
toc: false
toc-title: Содержание
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
 - '\makeatletter'
 - '\beamer@ignorenonframefalse'
 - '\makeatother'

## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
---

# Информация

## Докладчик

:::::::::::::: {.columns align=center}
::: {.column width="70%"}

  * Спелов Андрей Николаевич
  * НПИбд-02-23 Студ. билет: 1132231839
  * Российский университет дружбы народов
  * [1132231839@pfur.ru](mailto:1132231839@pfur.ru)

:::
::: {.column width="30%"}
:::
::::::::::::::

# Вводная часть

## Цель работы

- Целью данной работы является приобретение навыков настройки доступа групп пользователей к общим ресурсам по протоколу SMB.

# Основная часть

## Настройка сервера Samba

- Установка на сервере необходимых пакетов samba samba-client cifs-utils.

![](./image/1.png)

## Настройка сервера Samba

- Создание группы sambagroup для пользователей, которые будут работать с Samba сервером, и присвоение ей GID 1010 Добавление пользователя anspelov к группе sambagroup и создание общего каталога в файловой системе Linux, в который предполагается монтировать разделяемые ресурсы.

![](./image/2.png)

## Настройка сервера Samba

- Изменение параметра рабочей группы в файле конфигурации /etc/samba/smb.conf.

![](./image/3.png)

## Настройка сервера Samba

- Добавление раздела с описанием общего доступа к разделяемому ресурсу в конце файла /srv/sambashare.

![](./image/4.png)

## Настройка сервера Samba

- Проверка отсутствия синтаксических ошибок в файле smb.conf.

![](./image/5.png)

## Настройка сервера Samba

- Запуск демона Samba и просмотр его статуса.

![](./image/6.png)

## Настройка сервера Samba

- Попытка подключения к серверу с помощью smbclient.

![](./image/7.png)

## Настройка сервера Samba

- Просмотр файла конфигурации межсетевого экрана для Samba.

![](./image/8.png)

## Настройка сервера Samba

- Настройка межсетевого экрана.

![](./image/9.png)

## Настройка сервера Samba

- Настройка прав доступа для каталога с разделяемым ресурсом. Просмотр контекста безопасности SELinux и его настройка. Проверка изменений контекста безопасности и разрешение экспортировать разделяемые ресурсы для чтения и записи. Просмотр UID нашего пользователя и в какие группы он включён. Попытка создать под нашим пользователем anspelov файл на разделяемом ресурсе и добавление нашего пользователя anspelov в базу пользователей Samba.

![](./image/10.png)

## Монтирование файловой системы Samba на клиенте

- Установка на клиенте необходимых пакетов samba-client cifs-utils.

![](./image/11.png)

## Монтирование файловой системы Samba на клиенте

- Просмотр на клиенте файла конфигурации межсетевого экрана для клиента Samba.

![](./image/12.png)

## Монтирование файловой системы Samba на клиенте

- Настройка межсетевого экрана, создание на клиенте группы sambagroup и добавление в неё пользователя anspelov.

![](./image/13.png)

## Монтирование файловой системы Samba на клиенте

- Изменение на клиенте в файле конфигурации /etc/samba/smb.conf параметра рабочей группы.

![](./image/14.png)

## Монтирование файловой системы Samba на клиенте

- Проверка наличия общего доступа попыткой подключиться с клиента к серверу с помощью smbclient и smbclient под учётной записью нашего пользователя.

![](./image/15.png)

## Монтирование файловой системы Samba на клиенте

- Создание на клиенте точки монтирования и получение доступа к общему ресурсу с помощью mount. Проверка, что anspelov может записывать файлы на разделяемом ресурсе и демонтаж каталога /mnt/samba.

![](./image/16.png)

## ПМонтирование файловой системы Samba на клиенте

- Создание файла smbusers для настройки работы с Samba с помощью файла учётных данных в каталоге /etc/samba/.

![](./image/17.png)

## Монтирование файловой системы Samba на клиенте

- Добавление содержания в файл smbusers.

![](./image/18.png)

## Монтирование файловой системы Samba на клиенте

- Добавление на клиенте в файле /etc/fstab строки.

![](./image/19.png)

## Монтирование файловой системы Samba на клиенте

- Монтирование общего ресурса.

![](./image/20.png)

## Внесение изменений в настройки внутреннего окружения виртуальных машин

- Переход на виртуальной машине server в каталог для внесения изменений в настройки внутреннего окружения /vagrant/provision/server/, создание в нём каталога smb, в который помещаем в соответствующие подкаталоги конфигурационные файлы. Создание в каталоге /vagrant/provision/server исполняемого файла smb.sh.

![](./image/21.png)

## Внесение изменений в настройки внутреннего окружения виртуальных машин

- Открытие файла на редактирование и добавление в него скрипта.

![](./image/22.png)

## Внесение изменений в настройки внутреннего окружения виртуальных машин

- Переход на виртуальной машине client в каталог для внесения изменений в настройки внутреннего окружения /vagrant/provision/client/, создание в нём каталог smb, в который помещаем в соответствующие подкаталоги конфигурационные файлы. Создание в каталоге /vagrant/provision/client исполняемого файла smb.sh.

![](./image/23.png)

## Внесение изменений в настройки внутреннего окружения виртуальных машин

- Открытие файла на редактирование и добавление в него скрипта.

![](./image/24.png)

## Внесение изменений в настройки внутреннего окружения виртуальных машин

- Добавление конфигураций в конфигурационном файле Vagrantfile для сервера и клиента.

![](./image/25.png)

# Вывод

## Вывод

- В ходе выполнения лабораторной работы были приобретены навыки настройки доступа групп пользователей к общим ресурсам по протоколу SMB.