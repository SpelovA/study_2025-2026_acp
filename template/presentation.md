---
## Front matter
lang: ru-RU
title: Лабораторная работа №10
subtitle: Расширенные настройки SMTP-сервераФайл
author:
  - Спелов А. Н.
institute:
  - Российский университет дружбы народов, Москва, Россия
date: 30 октября 2025

## i18n babel
babel-lang: russian
babel-otherlangs: english

## Formatting pdf
toc: false
toc-title: Содержание
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
 - '\makeatletter'
 - '\beamer@ignorenonframefalse'
 - '\makeatother'

## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
---

# Информация

## Докладчик

:::::::::::::: {.columns align=center}
::: {.column width="70%"}

  * Спелов Андрей Николаевич
  * НПИбд-02-23 Студ. билет: 1132231839
  * Российский университет дружбы народов
  * [1132231839@pfur.ru](mailto:1132231839@pfur.ru)

:::
::: {.column width="30%"}
:::
::::::::::::::

# Вводная часть

## Цель работы

- Целью данной работы является приобретение практических навыков по конфигурированию SMTP-сервера в части настройки аутентификации.

# Основная часть

## Настройка LMTP в Dovecote

- Открытие режима суперпользователя и запуск в дополнительном терминале мониторинга работы почтовой службы.

![](./image/1.png)

## Настройка LMTP в Dovecote

- Добавление в список протоколов, с которыми может работать Dovecot, протокола LMTP.

![](./image/2.png)

## Настройка LMTP в Dovecote

- Настройка в Dovecot сервиса lmtp для связи с Postfix.

![](./image/3.png)

## Настройка LMTP в Dovecote

- Переопределение в Postfix с помощью postconf передачи сообщений не на прямую, а через заданный unix-сокет.

![](./image/4.png)

## Настройка LMTP в Dovecote

- Настройка в файле /etc/dovecot/conf.d/10-auth.conf формата имени пользователя для аутентификации в форме логина пользователя без указания домена.

![](./image/5.png)

## Настройка LMTP в Dovecote

- Перезапуск Postfix и Dovecot.

![](./image/6.png)

## Настройка LMTP в Dovecote

- Отправка из-под учётной записи своего пользователя письма с клиента.

![](./image/7.png)

## Настройка LMTP в Dovecote

- Просмотр содержания логов при мониторинге почтовой службы.

![](./image/8.png)

## Настройка LMTP в Dovecote

- Просмотр на сервере почтового ящика пользователя.

![](./image/9.png)

## Настройка SMTP-аутентификации

- Определение в файле /etc/dovecot/conf.d/10-master.conf службы аутентификации пользователей.

![](./image/10.png)

## Настройка SMTP-аутентификации

- Настройка для Postfix типа аутентификации SASL для smtpd и пути к соответствующему unix-сокету, настройка Postfix для приёма почты из Интернета только для обслуживаемых нашим сервером пользователей или для произвольных пользователей локальной машины, ограничение в настройках Postfix приёма почты только локальным адресом SMTP-сервера сети.

![](./image/11.png)

## Настройка SMTP-аутентификации

- Временный запуск для проверки работы аутентификации SMTP-сервера (порт 25) с возможностью аутентификации.

![](./image/12.png)

## Настройка SMTP-аутентификации

- Перезапуск Postfix и Dovecot.

![](./image/13.png)

## Настройка SMTP-аутентификации

- Установка на клиенте telnet.

![](./image/14.png)

## Настройка SMTP-аутентификации

- Получение на клиенте строки для аутентификации, подключение на клиенте к SMTP-серверу посредством telnet, тестирование соединения, проверка авторизации и завершение сессии telnet на клиенте.

![](./image/15.png)

## Настройка SMTP over TLS

- Настройка на сервере TLS и предварительное копирование необходимых файлов сертификата и ключа из каталога /etc/pki/dovecot в каталог /etc/pki/tls/ в соответствующие подкаталоги. Настройка конфигурации Postfix.

![](./image/16.png)

## Настройка SMTP over TLS

- Замена строк в файле /etc/postfix/master.cf для того чтобы запустить SMTP-сервер на 587-м порту.

![](./image/17.png)

## Настройка SMTP over TLS

- Настройка межсетевого экрана, разрешив работать службе smtp-submission.

![](./image/18.png)

## Настройка SMTP over TLS

- Перезапуск Postfix.

![](./image/19.png)

## Настройка SMTP over TLS

- Подключение на клиенте к SMTP-серверу через 587-й порт посредством openssl, тестирование подключения по telnet и проверка аутентификации.

![](./image/20.png)

## Настройка SMTP over TLS

- Корректирование настроек почтового клиента Evolution.

![](./image/21.png)

## Внесение изменений в настройки внутреннего окружения виртуальной машины

- Переход в каталог на виртуальной машине server для внесения изменений в настройки внутреннего окружения /vagrant/provision/server/ и помещение в соответствующие подкаталоги конфигурационных файлов Dovecot и Postfix.

![](./image/22.png)

## Внесение изменений в настройки внутреннего окружения виртуальной машины

- Внесение соответствующих изменений по расширенной конфигурации SMTP-сервера в файл /vagrant/provision/server/mail.sh.

![](./image/23.png)

## Внесение изменений в настройки внутреннего окружения виртуальной машины

- Внесение изменения в файл /vagrant/provision/client/mail.sh.

![](./image/24.png)

# Вывод

## Вывод

- В ходе выполнения лабораторной работы были приобретены практические навыки по конфигурированию SMTP-сервера в части настройки аутентификации.